# LiteEditor Undo/Redo ê¸°ëŠ¥ PRD (Product Requirements Document)

## ğŸ“Œ ê¸°ëŠ¥ ê°œìš”

LiteEditorì— ê³ ë„í™”ëœ Undo/Redo ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ì—¬, í…ìŠ¤íŠ¸ ì…ë ¥ë¶€í„° UL/OL/ì²´í¬ë¦¬ìŠ¤íŠ¸ ë“± ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ ì•¡ì…˜ê¹Œì§€ ì•ˆì •ì ìœ¼ë¡œ ë³µì›í•  ìˆ˜ ìˆëŠ” í¸ì§‘ ê¸°ë¡ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

---

## 1. ğŸ¯ ì œí’ˆ ëª©í‘œ

- ì‚¬ìš©ìì˜ ëª¨ë“  í¸ì§‘ í–‰ìœ„(í…ìŠ¤íŠ¸ ì…ë ¥, í”ŒëŸ¬ê·¸ì¸ ì ìš©, ì„œì‹ ë³€ê²½)ë¥¼ ê¸°ë¡í•˜ê³  ë³µì›
- `contenteditable` í™˜ê²½ì—ì„œ ë°œìƒí•˜ëŠ” ë³µì¡í•œ DOM ë³€ê²½ì‚¬í•­ ì¶”ì 
- ë¸Œë¼ìš°ì € ê¸°ë³¸ Undo/Redoë¥¼ ì™„ì „íˆ ëŒ€ì²´í•˜ëŠ” ì»¤ìŠ¤í…€ ì‹œìŠ¤í…œ
- Mac/Windows ë‹¨ì¶•í‚¤ ëª¨ë‘ ì§€ì›í•˜ëŠ” í¬ë¡œìŠ¤ í”Œë«í¼ í˜¸í™˜ì„±

---

## 2. âœ… êµ¬í˜„ ì™„ë£Œëœ ê¸°ëŠ¥

| ê¸°ëŠ¥ëª… | êµ¬í˜„ ìƒíƒœ | ì„¸ë¶€ì‚¬í•­ |
|--------|-----------|----------|
| í…ìŠ¤íŠ¸ ì…ë ¥ ê¸°ë¡ | âœ… ì™„ë£Œ | ë””ë°”ìš´ì‹±(800ms)ìœ¼ë¡œ ì—°ì† ì…ë ¥ ìµœì í™” |
| í”ŒëŸ¬ê·¸ì¸ ì•¡ì…˜ ê¸°ë¡ | âœ… ì™„ë£Œ | UL/OL/ì²´í¬ë¦¬ìŠ¤íŠ¸ ë“± ê°•ì œ ê¸°ë¡ ë°©ì‹ |
| DOM ìƒíƒœ ì €ì¥ | âœ… ì™„ë£Œ | `innerHTML` ê¸°ì¤€ ì „ì²´ ìŠ¤ëƒ…ìƒ· |
| ìŠ¤íƒ í¬ê¸° ì œí•œ | âœ… ì™„ë£Œ | ìµœëŒ€ 100ê°œ ê¸°ë¡, ìë™ ìˆœí™˜ |
| Redo ê¸°ëŠ¥ | âœ… ì™„ë£Œ | Undo í›„ ë˜ëŒë¦¬ê¸° ì§€ì› |
| ì¤‘ë³µ ê¸°ë¡ ë°©ì§€ | âœ… ì™„ë£Œ | ìŠ¤ë§ˆíŠ¸ ì¤‘ë³µ ê²€ì‚¬ ì•Œê³ ë¦¬ì¦˜ |
| í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ | âœ… ì™„ë£Œ | Mac(Cmd+Z), Windows(Ctrl+Z) ì§€ì› |
| íˆ´ë°” ë²„íŠ¼ ì—°ë™ | âœ… ì™„ë£Œ | ì‹¤ì‹œê°„ í™œì„±í™”/ë¹„í™œì„±í™” ìƒíƒœ |
| ì§ì ‘ í‚¤ë³´ë“œ ì²˜ë¦¬ | âœ… ì™„ë£Œ | core.js ë‹¨ì¶•í‚¤ ì‹œìŠ¤í…œ ìš°íšŒ |

---

## 3. ğŸ— ì•„í‚¤í…ì²˜ êµ¬ì¡°

### **í•µì‹¬ í´ë˜ìŠ¤**
```javascript
// íˆìŠ¤í† ë¦¬ ê´€ë¦¬ ì—”ì§„
class EnhancedHistoryManager {
  constructor(maxSize = 100)
  recordState(html, selection, actionName)
  forceRecord(html, selection, actionName) 
  undo(currentHtml, currentSelection)
  redo(currentHtml, currentSelection)
}

// ì—ë””í„°ë³„ íˆìŠ¤í† ë¦¬ ê´€ë¦¬
class EnhancedEditorHistoryManager {
  constructor(contentArea)
  recordBeforeAction(actionName)
  recordInputChange() // ë””ë°”ìš´ì‹± ì ìš©
  undo() / redo()
  applyState(state)
}
```

### **ì „ì—­ API**
```javascript
window.LiteEditorHistory = {
  recordState(contentArea, actionName),
  forceRecord(contentArea, actionName),
  recordBeforeAction(contentArea, actionName),
  getStatus(contentArea)
}
```

---

## 4. ğŸ”§ í•µì‹¬ ê¸°ëŠ¥ ì„¸ë¶€ì‚¬í•­

### **4.1 ìŠ¤ë§ˆíŠ¸ ê¸°ë¡ ì‹œìŠ¤í…œ**
- **ì¼ë°˜ ê¸°ë¡**: ì¤‘ë³µ ê²€ì‚¬ í›„ ì €ì¥
- **ê°•ì œ ê¸°ë¡**: í”ŒëŸ¬ê·¸ì¸ ì•¡ì…˜ ì‹œ ì¤‘ë³µ ê²€ì‚¬ ì—†ì´ ì €ì¥
- **ë””ë°”ìš´ì‹±**: ì—°ì† íƒ€ì´í•‘ ì‹œ 800ms ì§€ì—° í›„ ê¸°ë¡

### **4.2 í”ŒëŸ¬ê·¸ì¸ í†µí•©**
```javascript
// bulletList.js, numberedList.js, checkList.js
if (window.LiteEditorHistory) {
  window.LiteEditorHistory.forceRecord(contentArea, 'Before Action');
}
```

### **4.3 í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬**
- **ìº¡ì²˜ ë‹¨ê³„ ì²˜ë¦¬**: `addEventListener(..., true)`
- **ì¦‰ì‹œ ì „íŒŒ ì¤‘ë‹¨**: `stopImmediatePropagation()`
- **í”Œë«í¼ ê°ì§€**: Mac/Windows ìë™ êµ¬ë¶„

### **4.4 ë²„íŠ¼ ìƒíƒœ ê´€ë¦¬**
- ì‹¤ì‹œê°„ í™œì„±í™”/ë¹„í™œì„±í™”
- ì‹œê°ì  í”¼ë“œë°± (opacity ì¡°ì ˆ)
- ìŠ¤íƒ ìƒíƒœì— ë”°ë¥¸ ë™ì  ì—…ë°ì´íŠ¸

---

## 5. ğŸ§ª ê²€ì¦ëœ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### **5.1 ê¸°ë³¸ ê¸°ëŠ¥**
- âœ… í…ìŠ¤íŠ¸ ì…ë ¥ â†’ Undo â†’ Redo
- âœ… ì—°ì† íƒ€ì´í•‘ â†’ í•˜ë‚˜ì˜ ê¸°ë¡ìœ¼ë¡œ í†µí•©
- âœ… Enter/Delete/Backspace â†’ ì¦‰ì‹œ ê¸°ë¡

### **5.2 í”ŒëŸ¬ê·¸ì¸ ì—°ë™**
- âœ… UL ì ìš© â†’ Undo â†’ ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µì›
- âœ… OL ì ìš© â†’ Undo â†’ ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µì›  
- âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸ ì ìš© â†’ Undo â†’ ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µì›
- âœ… Tab ë“¤ì—¬ì“°ê¸° â†’ Undo â†’ ì´ì „ ìƒíƒœ ë³µì›

### **5.3 í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤**
- âœ… Mac: Cmd+Z (Undo), Shift+Cmd+Z (Redo)
- âœ… Windows: Ctrl+Z (Undo), Ctrl+Shift+Z (Redo)
- âœ… íˆ´ë°” ë²„íŠ¼ê³¼ ë‹¨ì¶•í‚¤ ë™ì¼ ë™ì‘

### **5.4 ì—ì§€ ì¼€ì´ìŠ¤**
- âœ… ë¹ˆ ìŠ¤íƒì—ì„œ Undo ì‹œë„ â†’ ë¬´ì‹œ
- âœ… ìŠ¤íƒ ê°€ë“ ì°¸ â†’ ê°€ì¥ ì˜¤ë˜ëœ ê¸°ë¡ ìë™ ì‚­ì œ
- âœ… Undo í›„ ìƒˆ ì…ë ¥ â†’ Redo ìŠ¤íƒ ì´ˆê¸°í™”

---

## 6. ğŸ“Š ì„±ëŠ¥ ìµœì í™”

### **6.1 ë©”ëª¨ë¦¬ ê´€ë¦¬**
- ìµœëŒ€ 100ê°œ ê¸°ë¡ ì œí•œ
- ê°€ì¥ ì˜¤ë˜ëœ ê¸°ë¡ ìë™ ìˆœí™˜ ì‚­ì œ
- ì„ íƒ ì˜ì—­ ì •ë³´ ê²½ëŸ‰í™”

### **6.2 ì…ë ¥ ìµœì í™”**
- ë””ë°”ìš´ì‹±ìœ¼ë¡œ ê³¼ë„í•œ ê¸°ë¡ ë°©ì§€
- ì¤‘ë³µ ìƒíƒœ ìŠ¤ë§ˆíŠ¸ ê°ì§€
- íŠ¹ìˆ˜ í‚¤(Enter/Delete) ì¦‰ì‹œ ê¸°ë¡

### **6.3 DOM ì¡°ì‘ ìµœì í™”**
- ìƒíƒœ ì ìš© ì‹œ ê¸°ë¡ ì¼ì‹œ ì¤‘ë‹¨
- ì§§ì€ íƒ€ì´ë°ìœ¼ë¡œ í”Œë˜ê·¸ ë³µì› (50ms â†’ 30ms)
- ë¶ˆí•„ìš”í•œ ì´ë²¤íŠ¸ ë°œìƒ ìµœì†Œí™”

---

## 7. ğŸ”® í–¥í›„ í™•ì¥ ê³„íš

### **Phase 2 (ì¶”í›„ êµ¬í˜„ ì˜ˆì •)**
- **ì„ íƒ ì˜ì—­ ë³µì›**: ì •í™•í•œ ì»¤ì„œ ìœ„ì¹˜ ë³µì›
- **ë¸Œëœì¹˜ íˆìŠ¤í† ë¦¬**: Undo í›„ ë¶„ê¸°ëœ í¸ì§‘ ê²½ë¡œ ê´€ë¦¬
- **íˆìŠ¤í† ë¦¬ ì‹œê°í™”**: ì‹œê°„ìˆœ í¸ì§‘ ê¸°ë¡ UI
- **ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì—°ë™**: ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ íˆìŠ¤í† ë¦¬ ìœ ì§€

### **ì„±ëŠ¥ ê°œì„ **
- **ë¸íƒ€ ì €ì¥**: ì „ì²´ HTML ëŒ€ì‹  ë³€ê²½ë¶„ë§Œ ì €ì¥
- **ì••ì¶• ì•Œê³ ë¦¬ì¦˜**: í° ì½˜í…ì¸  ì••ì¶• ì €ì¥
- **ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: Web Worker í™œìš©í•œ ë¹„ë™ê¸° ì²˜ë¦¬

---

## 8. âœ… ì™„ì„±ë„ ì§€í‘œ

### **ê¸°ëŠ¥ ì™„ì„±ë„: 100%**
- ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ
- í¬ë¡œìŠ¤ í”Œë«í¼ í˜¸í™˜ì„± í™•ë³´
- í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ ì™„ì „ í†µí•©

### **ì•ˆì •ì„±: 95%**
- ì—ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬ ì™„ë£Œ
- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€
- ì—ëŸ¬ í•¸ë“¤ë§ êµ¬í˜„

### **ì‚¬ìš©ì„±: 100%**
- ì§ê´€ì ì¸ í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
- ì‹œê°ì  í”¼ë“œë°± ì œê³µ
- ë¸Œë¼ìš°ì € ê¸°ë³¸ ë™ì‘ê³¼ ë™ì¼í•œ UX

---

## 9. ğŸ“š ê°œë°œì ê°€ì´ë“œ

### **í”ŒëŸ¬ê·¸ì¸ì—ì„œ íˆìŠ¤í† ë¦¬ ì‚¬ìš©ë²•**
```javascript
// ì•¡ì…˜ ì „ ìƒíƒœ ê¸°ë¡
if (window.LiteEditorHistory) {
  window.LiteEditorHistory.forceRecord(contentArea, 'Before Plugin Action');
}

// í”ŒëŸ¬ê·¸ì¸ ë¡œì§ ì‹¤í–‰
applyPluginLogic();

// ì•¡ì…˜ í›„ ìƒíƒœ ê¸°ë¡ (ì„ íƒì‚¬í•­)
setTimeout(() => {
  if (window.LiteEditorHistory) {
    window.LiteEditorHistory.recordState(contentArea, 'After Plugin Action');
  }
}, 100);
```

### **ë””ë²„ê¹… ì •ë³´ í™•ì¸**
```javascript
// í˜„ì¬ íˆìŠ¤í† ë¦¬ ìƒíƒœ í™•ì¸
const status = window.LiteEditorHistory.getStatus(contentArea);
console.log(status); // {canUndo, canRedo, undoCount, redoCount, ...}
```

---

**âœ¨ ì´ PRDëŠ” í˜„ì¬ êµ¬í˜„ëœ LiteEditor History ì‹œìŠ¤í…œì˜ ì‹¤ì œ ìŠ¤í™ì„ ë°˜ì˜í•©ë‹ˆë‹¤.**
