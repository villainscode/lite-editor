# Check List Plugin ê°œë°œ ëª…ì„¸ì„œ (v2.0 - ì™„ì„± ë²„ì „)

## 1. ê°œìš”

LiteEditorì—ì„œ ì‚¬ìš©í•˜ëŠ” ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•œ í”ŒëŸ¬ê·¸ì¸ì…ë‹ˆë‹¤. ì„ íƒí•œ í…ìŠ¤íŠ¸ ì˜ì—­ì— ì²´í¬ë°•ìŠ¤ ë¦¬ìŠ¤íŠ¸ë¥¼ ì ìš©/í•´ì œí•˜ê³ , ë“¤ì—¬ì“°ê¸° ë ˆë²¨ ê´€ë¦¬ ë° ì²´í¬ë°•ìŠ¤ ìƒíƒœì— ë”°ë¥¸ í…ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ ë³€ê²½ì„ ì§€ì›í•©ë‹ˆë‹¤.

**âœ… í˜„ì¬ ìƒíƒœ**: ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„ ì™„ë£Œ, ì£¼ìš” ë²„ê·¸ í•´ê²° ì™„ë£Œ

## 2. í•µì‹¬ ê¸°ëŠ¥ (êµ¬í˜„ ì™„ë£Œ)

### 2.1 ì²´í¬ë¦¬ìŠ¤íŠ¸ í† ê¸€ âœ…
- ì„ íƒí•œ í…ìŠ¤íŠ¸ ë¸”ë¡ì— ì²´í¬ë°•ìŠ¤ ë¦¬ìŠ¤íŠ¸ ì„œì‹ ì ìš©/í•´ì œ
- ì„œì‹ ì ìš© í›„ì—ë„ ì›ë˜ ì„ íƒ ì˜ì—­ ìœ ì§€ (PluginUtil.selection í™œìš©)
- ë‹¤ì¤‘ ë¼ì¸ ì„ íƒ ì‹œ ëª¨ë“  ë¼ì¸ì´ ê· ì¼í•˜ê²Œ ì²˜ë¦¬
- BR íƒœê·¸ ê¸°ì¤€ í…ìŠ¤íŠ¸ ë¶„ë¦¬ ë° ê° ë¼ì¸ë³„ ì²´í¬ë°•ìŠ¤ ìƒì„±
- ì²´í¬ë¦¬ìŠ¤íŠ¸ â†” ì¼ë°˜ í…ìŠ¤íŠ¸ ì™„ë²½í•œ ì–‘ë°©í–¥ ë³€í™˜

### 2.2 ì²´í¬ë°•ìŠ¤ ê¸°ëŠ¥ âœ…
- ì²´í¬ë°•ìŠ¤ ì²´í¬ ì‹œ í•´ë‹¹ í…ìŠ¤íŠ¸ì— ì·¨ì†Œì„ (line-through) ìë™ ì ìš©
- ì²´í¬ë°•ìŠ¤ í•´ì œ ì‹œ ì·¨ì†Œì„  ìë™ ì œê±°
- ì²´í¬ë°•ìŠ¤ì™€ ë¼ë²¨ ë¶„ë¦¬ (htmlFor ì œê±°ë¡œ ë¼ë²¨ í´ë¦­ ë°©ì§€)
- ê° ì²´í¬ë°•ìŠ¤ëŠ” íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ ê³ ìœ  ID ìë™ ìƒì„±
- change ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ í†µí•œ ì‹¤ì‹œê°„ ìŠ¤íƒ€ì¼ ë³€ê²½

### 2.3 ë“¤ì—¬ì“°ê¸° ê´€ë¦¬ âœ…
- **Tab í‚¤**: ì„ íƒëœ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ë“¤ì—¬ì“°ê¸° (20px ë‹¨ìœ„)
- **Shift+Tab í‚¤**: ì²´í¬ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ë‚´ì–´ì“°ê¸°
- `data-indent-level` ì†ì„±ìœ¼ë¡œ ê¹Šì´ ì¶”ì  (0~ë¬´ì œí•œ)
- `margin-left` ìŠ¤íƒ€ì¼ë¡œ ì‹œê°ì  ë“¤ì—¬ì“°ê¸° í‘œí˜„
- **ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€**: `stopImmediatePropagation()`ë¡œ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ ê°„ì„­ ì°¨ë‹¨

### 2.4 íŠ¹ìˆ˜ í‚¤ ì²˜ë¦¬ âœ…
- **Enter í‚¤**: ìƒˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± + **depth ìƒì†**
- **ë¹ˆ ì•„ì´í…œì—ì„œ Enter í‚¤**: ì²´í¬ë¦¬ìŠ¤íŠ¸ ì¢…ë£Œ ë° ì¼ë°˜ í…ìŠ¤íŠ¸ë¡œ ì „í™˜
- **Tab/Shift+Tab**: í˜„ì¬ ì•„ì´í…œ ë“¤ì—¬ì“°ê¸°/ë‚´ì–´ì“°ê¸° (ì •í™•í•œ 20px ë‹¨ìœ„)
- **Alt+K**: ì²´í¬ë¦¬ìŠ¤íŠ¸ í† ê¸€ ë‹¨ì¶•í‚¤
- **ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€**: `isProcessingEnter` í”Œë˜ê·¸ í™œìš©

## 3. ê¸°ìˆ ì  êµ¬í˜„ ì‚¬í•­ (v2.0 íŠ¹ì§•)

### 3.1 ì´ë²¤íŠ¸ ì²˜ë¦¬ ìµœì í™” âœ…
```javascript
// Capture phase ì´ë²¤íŠ¸ ë“±ë¡ìœ¼ë¡œ ìµœìš°ì„  ì²˜ë¦¬
document.addEventListener('keydown', handleChecklistKeys, true);

// ì™„ì „í•œ ì´ë²¤íŠ¸ ì°¨ë‹¨ìœ¼ë¡œ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ ê°„ì„­ ë°©ì§€
event.preventDefault();
event.stopPropagation();
event.stopImmediatePropagation();
```

### 3.2 Depth ìƒì† ë©”ì»¤ë‹ˆì¦˜ âœ…
```javascript
// Enter í‚¤ ì‹œ í˜„ì¬ ì•„ì´í…œì˜ depthë¥¼ ìƒˆ ì•„ì´í…œì— ìƒì†
function createSingleChecklistItem(text, inheritIndent = 0) {
  if (inheritIndent > 0) {
    container.setAttribute('data-indent-level', inheritIndent);
    container.style.marginLeft = `${inheritIndent * 20}px`;
  }
}

// í˜„ì¬ depth í™•ì¸ í›„ ìƒì†
const currentIndent = parseInt(item.getAttribute('data-indent-level') || '0');
const newItem = createSingleChecklistItem('', currentIndent);
```

### 3.3 ì¤‘ë³µ ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜ âœ…
```javascript
// Enter í‚¤ ì¤‘ë³µ ì²˜ë¦¬ ë°©ì§€
let isProcessingEnter = false;

function handleEnterKey(item) {
  if (isProcessingEnter) return;
  isProcessingEnter = true;
  // ... ì²˜ë¦¬ ë¡œì§
  setTimeout(() => { isProcessingEnter = false; }, 100);
}

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ë“±ë¡ ë°©ì§€
let isEventListenerRegistered = false;
```

### 3.4 í¬ì»¤ìŠ¤ ê´€ë¦¬ ì‹œìŠ¤í…œ âœ…
```javascript
// ìƒˆ ì•„ì´í…œ ìƒì„± í›„ ìë™ í¬ì»¤ìŠ¤ ì´ë™
setTimeout(() => {
  const newLabel = newItem.querySelector('label');
  if (newLabel) {
    PluginUtil.selection.moveCursorTo(newLabel, 0);
  }
}, 0);
```

### 3.5 íˆìŠ¤í† ë¦¬ í†µí•© âœ…
- `LiteEditorHistory.recordState()` ìë™ í˜¸ì¶œ
- ì²´í¬ë¦¬ìŠ¤íŠ¸ ì ìš© ì „ ìƒíƒœ ìë™ ì €ì¥
- Undo/Redo ì§€ì› ì™„ë£Œ

## 4. í•´ê²°ëœ ì£¼ìš” ë²„ê·¸ë“¤

### 4.1 Enter í‚¤ Depth ìƒì† ë¬¸ì œ âœ… FIXED
**ë¬¸ì œ**: 4 depthì—ì„œ Enter â†’ 0 depthë¡œ ë¦¬ì…‹ë˜ëŠ” í˜„ìƒ
**í•´ê²°**: `createSingleChecklistItem`ì— `inheritIndent` ë§¤ê°œë³€ìˆ˜ ì¶”ê°€, í˜„ì¬ depth ìƒì†

### 4.2 Tab í‚¤ ì´ë²¤íŠ¸ ì¤‘ë³µ ë¬¸ì œ âœ… FIXED
**ë¬¸ì œ**: ì—¬ëŸ¬ í”ŒëŸ¬ê·¸ì¸(bulletList, numberedList, formatIndent, checkList)ì—ì„œ Tab ì´ë²¤íŠ¸ ì¤‘ë³µ ì²˜ë¦¬ë¡œ 40px ì í”„
**í•´ê²°**: `stopImmediatePropagation()` + capture phaseë¡œ checkListì—ì„œ ë…ì  ì²˜ë¦¬

### 4.3 Enter í‚¤ ì¤‘ë³µ ì‹¤í–‰ ë¬¸ì œ âœ… FIXED
**ë¬¸ì œ**: í•œ ë²ˆì˜ Enter í‚¤ ì…ë ¥ìœ¼ë¡œ ì²´í¬ë°•ìŠ¤ 2ê°œê°€ ìƒì„±ë˜ëŠ” í˜„ìƒ
**í•´ê²°**: `isProcessingEnter` í”Œë˜ê·¸ + 100ms ì“°ë¡œí‹€ë§

### 4.4 ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ë“±ë¡ ë¬¸ì œ âœ… FIXED
**ë¬¸ì œ**: í”ŒëŸ¬ê·¸ì¸ ì¬ë¡œë“œ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ë“±ë¡
**í•´ê²°**: `isEventListenerRegistered` í”Œë˜ê·¸ + cleanup í•¨ìˆ˜

## 5. í˜„ì¬ êµ¬í˜„ ìƒíƒœ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 5.1 ê¸°ë³¸ ê¸°ëŠ¥ âœ… ëª¨ë‘ ì™„ë£Œ
- [x] ì„ íƒ ì˜ì—­ì—ë§Œ ì˜í–¥ì„ ë¯¸ì¹˜ê³  ë¬¸ì„œì˜ ë‹¤ë¥¸ ë¶€ë¶„ì€ ë³€ê²½ë˜ì§€ ì•ŠìŒ
- [x] ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì ìš©/í•´ì œ í† ê¸€ ì •ìƒ ì‘ë™
- [x] ì ìš©/í•´ì œ í›„ì—ë„ ì›ë˜ ì„ íƒí•œ ì˜ì—­ ì •í™•íˆ ìœ ì§€
- [x] ë°˜ë³µ í† ê¸€ ì‹œì—ë„ ëª¨ë“  ì„ íƒ ë¼ì¸ ì •í™•íˆ ì²˜ë¦¬ (ë§ˆì§€ë§‰ ë¼ì¸ ëˆ„ë½ ì—†ìŒ)
- [x] ì²´í¬ë°•ìŠ¤ í´ë¦­ ì‹œ í…ìŠ¤íŠ¸ì— ì·¨ì†Œì„  ì •í™•íˆ ì ìš©/í•´ì œ
- [x] ë¼ë²¨ í´ë¦­ ì‹œ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ë³€ê²½ë˜ì§€ ì•ŠìŒ
- [x] Alt+K ë‹¨ì¶•í‚¤ë¡œ ì²´í¬ë¦¬ìŠ¤íŠ¸ í† ê¸€ ì •ìƒ ì‘ë™

### 5.2 ê³ ê¸‰ ê¸°ëŠ¥ âœ… ëª¨ë‘ ì™„ë£Œ
- [x] Tab/Shift+Tabìœ¼ë¡œ ë“¤ì—¬ì“°ê¸°/ë‚´ì–´ì“°ê¸° ì •ìƒ ì‘ë™ (20px ë‹¨ìœ„)
- [x] Enter í‚¤ë¡œ ìƒˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„± (depth ìƒì†)
- [x] ë¹ˆ í•­ëª©ì—ì„œ Enter í‚¤ ì…ë ¥ ì‹œ ì²´í¬ë¦¬ìŠ¤íŠ¸ì—ì„œ ì •ìƒ ë¹ ì ¸ë‚˜ì˜´
- [x] ë¬´ì œí•œ depth ì§€ì› (1 depth = 20px, 2 depth = 40px...)
- [x] ì´ë²¤íŠ¸ ì¤‘ë³µ ë°©ì§€ë¡œ ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ê³¼ ì™„ì „ ë¶„ë¦¬

### 5.3 ë²„ê·¸ í•´ê²° âœ… ëª¨ë‘ ì™„ë£Œ
- [x] Enter í‚¤ depth ìƒì† ë¬¸ì œ í•´ê²°
- [x] Tab í‚¤ 40px ì í”„ ë¬¸ì œ í•´ê²°
- [x] Enter í‚¤ ì¤‘ë³µ ì‹¤í–‰ ë¬¸ì œ í•´ê²°
- [x] ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ë“±ë¡ ë¬¸ì œ í•´ê²°

## 6. ë””ë²„ê¹… ë° ë¡œê¹… ì‹œìŠ¤í…œ

### 6.1 ìƒì„¸ ë¡œê¹… êµ¬í˜„ âœ…
```javascript
// ëª¨ë“  ì£¼ìš” í•¨ìˆ˜ì— ë¡œê¹… ì‹œìŠ¤í…œ êµ¬í˜„
console.log('ğŸŸ¢ [CheckList] createSingleChecklistItem ìƒì„±:', {...});
console.log('â [CheckList] Enter í‚¤ ì²˜ë¦¬ ì‹œì‘:', item);
console.log('ğŸ”’ [CheckList] í‚¤ ì´ë²¤íŠ¸ ë…ì  ì²˜ë¦¬:', {...});
```

### 6.2 ë””ë²„ê¹… ì •ë³´
- **ìƒì„±ëœ ì•„ì´í…œ ì¶”ì **: íƒ€ì„ìŠ¤íƒ¬í”„, í…ìŠ¤íŠ¸, depth, HTML êµ¬ì¡°
- **í‚¤ ì´ë²¤íŠ¸ ì¶”ì **: ì–´ë–¤ í‚¤ê°€ ì–¸ì œ ì²˜ë¦¬ë˜ì—ˆëŠ”ì§€
- **depth ë³€ê²½ ì¶”ì **: ë“¤ì—¬ì“°ê¸° ì „í›„ ìƒíƒœ ë¹„êµ
- **ì„ íƒ ì˜ì—­ ì¶”ì **: ë³€í™˜ ì „í›„ ì„ íƒ ì˜ì—­ ì •ë³´

## 7. ì„±ëŠ¥ ìµœì í™” íŠ¹ì§•

### 7.1 ì´ë²¤íŠ¸ ìµœì í™” âœ…
- **í‚¤ í•„í„°ë§ ìš°ì„ **: Enter/Tab í‚¤ë§Œ ì²˜ë¦¬í•˜ì—¬ ì„±ëŠ¥ í–¥ìƒ
- **ì»¨í…ìŠ¤íŠ¸ í™•ì¸**: ì²´í¬ë¦¬ìŠ¤íŠ¸ ì˜ì—­ì—ì„œë§Œ ì´ë²¤íŠ¸ ì²˜ë¦¬
- **ì“°ë¡œí‹€ë§**: 100ms ì¤‘ë³µ ë°©ì§€ë¡œ ê³¼ë„í•œ ì²˜ë¦¬ ë°©ì§€

### 7.2 DOM ì¡°ì‘ ìµœì í™” âœ…
- **Fragment ì‚¬ìš©**: ì—¬ëŸ¬ ì•„ì´í…œ ìƒì„± ì‹œ í•œ ë²ˆì— DOM ì‚½ì…
- **setTimeout í™œìš©**: DOM ë³€ê²½ í›„ ì•ˆì •ì ì¸ í¬ì»¤ìŠ¤ ì´ë™
- **ì„ íƒì  ìŠ¤íƒ€ì¼ ì ìš©**: í•„ìš”í•œ ê²½ìš°ì—ë§Œ ìŠ¤íƒ€ì¼ ë³€ê²½

## 8. ì½”ë“œ ì•„í‚¤í…ì²˜ íŠ¹ì§•

### 8.1 ëª¨ë“ˆí™” ì„¤ê³„ âœ…
```javascript
// ê° ê¸°ëŠ¥ë³„ ë…ë¦½ í•¨ìˆ˜
- createSingleChecklistItem()    // ì•„ì´í…œ ìƒì„±
- handleEnterKey()              // Enter í‚¤ ì²˜ë¦¬  
- handleTabIndent()             // Tab í‚¤ ì²˜ë¦¬
- toggleCheckList()             // í† ê¸€ ê¸°ëŠ¥
- initCheckboxHandlers()        // ì´ˆê¸°í™”
```

### 8.2 ì—ëŸ¬ ë°©ì§€ ì„¤ê³„ âœ…
- **Null ì²´í¬**: ëª¨ë“  DOM ìš”ì†Œ ì ‘ê·¼ ì „ ì¡´ì¬ í™•ì¸
- **íƒ€ì… ì²´í¬**: `parseInt()` ì‚¬ìš© ì‹œ ê¸°ë³¸ê°’ ì„¤ì •
- **ì•ˆì „í•œ ì´ë²¤íŠ¸ ì²˜ë¦¬**: ë¦¬ì‚¬ì´ì¦ˆ ì¤‘ ì´ë²¤íŠ¸ ë¬´ì‹œ
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€**: cleanup í•¨ìˆ˜ë¡œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì •ë¦¬

## 9. í–¥í›„ ê°œì„  ê°€ëŠ¥ ì‚¬í•­

### 9.1 UI/UX ê°œì„ 
- [ ] ì²´í¬ëœ í•­ëª© ìë™ ì •ë ¬ ì˜µì…˜ (ì™„ë£Œ í•­ëª© ì•„ë˜ë¡œ ì´ë™)
- [ ] ë‹¤ì–‘í•œ ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ í…Œë§ˆ ì§€ì›
- [ ] ëª¨ë°”ì¼ í„°ì¹˜ ì œìŠ¤ì²˜ ìµœì í™”

### 9.2 ê¸°ëŠ¥ í™•ì¥
- [ ] ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì¬ì •ë ¬
- [ ] ì²´í¬ë¦¬ìŠ¤íŠ¸ í•­ëª© ì¼ê´„ ì²´í¬/í•´ì œ ê¸°ëŠ¥
- [ ] ë¶€ëª¨-ìì‹ ê´€ê³„ ê¸°ë°˜ ì¤‘ì²© ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ì²´í¬ë°•ìŠ¤ ì„ íƒ ìƒíƒœ ë¡œì»¬ ì €ì¥/ë³µì›

### 9.3 ê°œë°œì ë„êµ¬
- [ ] ì²´í¬ë¦¬ìŠ¤íŠ¸ êµ¬ì¡° ì‹œê°í™” ë„êµ¬
- [ ] ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ
- [ ] ìë™í™”ëœ ìœ ë‹› í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸

## 10. ì™„ì„±ëœ í•µì‹¬ ì½”ë“œ ìŠ¤ë‹ˆí«

### 10.1 Depth ìƒì† ì²´í¬ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œ ìƒì„±
```javascript
function createSingleChecklistItem(text, inheritIndent = 0) {
  const itemId = `checklist-item-${Date.now()}-${checklistItemCounter++}`;
  
  const container = PluginUtil.dom.createElement('div', {
    className: 'flex items-center gap-2 my-1 checklist-item'
  });
  
  // âœ… depth ìƒì† ì ìš©
  if (inheritIndent > 0) {
    container.setAttribute('data-indent-level', inheritIndent);
    container.style.marginLeft = `${inheritIndent * 20}px`;
  }
  
  // checkbox, label ìƒì„± ë° ì´ë²¤íŠ¸ ì—°ê²°
  // ...
  
  return container;
}
```

### 10.2 ì¤‘ë³µ ë°©ì§€ Enter í‚¤ ì²˜ë¦¬
```javascript
function handleEnterKey(item) {
  if (isProcessingEnter) return;
  isProcessingEnter = true;
  
  const currentIndent = parseInt(item.getAttribute('data-indent-level') || '0');
  const newItem = createSingleChecklistItem('', currentIndent);
  item.after(newItem);
  
  setTimeout(() => { isProcessingEnter = false; }, 100);
}
```

### 10.3 ì™„ì „í•œ ì´ë²¤íŠ¸ ì°¨ë‹¨ ì‹œìŠ¤í…œ
```javascript
const handleChecklistKeys = function(event) {
  if (event.key !== 'Enter' && event.key !== 'Tab') return;
  
  const activeItem = findActiveChecklistItem();
  if (!activeItem) return;
  
  // âœ… ë‹¤ë¥¸ í”ŒëŸ¬ê·¸ì¸ ì™„ì „ ì°¨ë‹¨
  event.preventDefault();
  event.stopPropagation();
  event.stopImmediatePropagation();
  
  // ì²˜ë¦¬ ì‹¤í–‰...
};
```

**ğŸ‰ ê²°ë¡ **: checkList í”ŒëŸ¬ê·¸ì¸ì€ ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ì´ ì™„ë²½íˆ êµ¬í˜„ë˜ì—ˆìœ¼ë©°, ì£¼ìš” ë²„ê·¸ë“¤ì´ í•´ê²°ë˜ì–´ í”„ë¡œë•ì…˜ ì‚¬ìš© ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
